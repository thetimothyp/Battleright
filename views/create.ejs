<!-- views/create.ejs -->
<!doctype html>
<html>
<head>
    <title>Battleright</title>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/edit.css">
</head>
<body>
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Battleright</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="/">Home</a></li>
        <li><a href="/guides">All Guides</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <% if (user == 0) { %>
            <li><a href="/login">Login</a></li>
            <li><a href="/signup">Sign Up</a></li>
        <% } else {%>
            <li><a href="/profile/guides">My Guides</a></li>
            <li class="active"><a href="/create">New Guide</a></li>
            <li><a href="/profile">Profile</a></li>
            <li><a href="/logout">Log Out</a></li>
        <% } %>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
<div class="container">

        <!-- LOCAL INFORMATION -->
        <div class="col-sm-8 col-sm-offset-2">

            <hr>
            <div id="chapters">
                <form action="/guides" method="post" id="guide">
                    <div class="row">
                    Guide Title: <input type="text" name="title"><hr>
                    Champion: 
                    <select name="champion">
                        <% for (var i = 0; i < champions.length; i++) { %>
                            <option value="<%=champions[i].name%>"><%=champions[i].name%></option>
                        <% } %>
                    </select>
                    </div>

                    <hr>
                    <div class="row">
                    <div id="battlerites">
                        <h3>Battlerites</h3><hr>
                        <div class="tier" id="tier1">
                            <h4>Tier 1</h4>
                            <div class="battlerite col-sm-4" id="1-1">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <div class="battlerite col-sm-4" id="1-2">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <div class="battlerite col-sm-4" id="1-3">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <h5>Tier 1 comments:</h5>
                            <textarea name="tier1comments" rows="10"></textarea>
                        </div>
                        <hr>
                        <div class="tier" id="tier2">
                            <h4>Tier 2</h4>
                            <div class="battlerite col-sm-4" id="2-1">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <div class="battlerite col-sm-4" id="2-2">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <div class="battlerite col-sm-4" id="2-3">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <h5>Tier 2 comments:</h5>
                            <textarea name="tier2comments" rows="10"></textarea>
                        </div>
                        <hr>
                        <div class="tier" id="tier3">
                            <h4>Tier 3</h4>
                            <div class="battlerite col-sm-4" id="3-1">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <div class="battlerite col-sm-4" id="3-2">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <div class="battlerite col-sm-4" id="3-3">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <h5>Tier 3 comments:</h5>
                            <textarea name="tier3comments" rows="10"></textarea>
                        </div>
                        <hr>
                        <div class="tier" id="tier4">
                            <h4>Tier 4</h4>
                            <div class="battlerite col-sm-4" id="4-1">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <div class="battlerite col-sm-4" id="4-2">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <div class="battlerite col-sm-4" id="4-3">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <h5>Tier 4 comments:</h5>
                            <textarea name="tier4comments" rows="10"></textarea>
                        </div>
                        <hr>
                        <div class="tier" id="tier5">
                            <h4>Tier 5</h4>
                            <div class="battlerite col-sm-6" id="5-1">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <div class="battlerite col-sm-6" id="5-2">
                                <h5 class="br-title">Frenzy</h5>
                                <h6 class="br-type"></h6>
                                <img src="/images/battlerites/Frenzy.png">
                                <p class="br-desc"></p>
                            </div>
                            <h5>Tier 5 comments:</h5>
                            <textarea name="tier5comments" rows="10"></textarea>
                        </div>
                    </div>
                    </div>
                    <hr>
                    <div class="row">
                    <h3>Additional Chapters</h3>
                    <hr>
                    <div id="ch0">
                        Chapter Title: <input type="text" name="ch_title">
                        <br><br>
                        <textarea rows="10" cols="50" name="ch_body" style="width: 100%;"></textarea>
                    </div>
                    </div>
                    <script>var i = 0;</script>
                </form>
            </div>
            <hr>
            <div class="row">
            <button class="btn btn-primary btn-lg add-more">Add Chapter</button>
            <hr>
            <button type="submit" form="guide" class="btn btn-primary btn-lg">Submit</button>
            </div>

        </div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="/scripts/edit.js"></script>
<script>
    var champion = $('select option:selected').text();
    getBattlerites(champion);
    $('select').on('change', function(e) {
        champion = $('select option:selected').text();
        getBattlerites(champion);
    })

    function getBattlerites(champion) {
        var loc = location.protocol+'//'+location.hostname+(location.port ? ':'+location.port: '');
        var path = loc + "/api/champions/" + champion + "/battlerites";
        httpGetAsync(path, function(data) {
            $.each(JSON.parse(data), function(i, br) {
                console.log(br);
                $("#" + br.tier + " .br-title").text(br.name);
                $("#" + br.tier + " .br-desc").text(br.desc);
                $("#" + br.tier + " .br-type").text(br.type);
            })
        })
    }

    function httpGetAsync(theUrl, callback)
    {
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.onreadystatechange = function() { 
            if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                callback(xmlHttp.responseText);
        }
        xmlHttp.open("GET", theUrl, true); // true for asynchronous 
        xmlHttp.send(null);
    }
</script>
</body>
</html>